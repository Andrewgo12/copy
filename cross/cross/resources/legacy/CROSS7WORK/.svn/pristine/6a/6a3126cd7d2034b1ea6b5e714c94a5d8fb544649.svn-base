<?php

require_once "Web/WebRegistry.class.php";
require_once "Web/WebSession.class.php";

set_time_limit(0);

class FrontController {

    public static function execute() {

        $command = WebRegistry::getWebCommand();
		print("A");
        if (PEAR::isError($command)) {
            // $view_name = WebRegistry::getErrorView();
            echo "command not found";
        }
		print("A");
		
        $result = $command->execute();
		print("A");
		
        if (PEAR::isError($result)) {
		print("B");

            echo $result->getMessage();
        } else {
		    print("C");

            $view_name = WebRegistry::getWebCommandView($result);
            
            if (PEAR::isError($view_name)) {
                echo $view_name->getMessage();
		        print("D");
                
            } else {
                $view = WebRegistry::getWebView($view_name);
		        print("E");
                
                if (PEAR::isError($view)){
                    echo $view->getMessage();
                } else {
                    $view->show();
                }
            }
        }
        
        /*
        // an error ??
        if (!PEAR::isError($command)) {
                $view_name = $command->execute();

                $view =& Application::get_Web_View($_REQUEST["action"], $view_name);

                // there is an error getting the command ??
                if (!PEAR::isError($view)) {
                    $view_name = $view->show();
                }
        // need to call a view
        } else if (!isset($_REQUEST["view"])) {
            $view =& Application::get_Web_View($_REQUEST["view"]);

            // there is an error getting the command ??
            if (!PEAR::isError($view)) {
                $view_name = $view->show();
            }
        }
        */
    }

}

?>